<!DOCTYPE html>
<html>
<% include ../partials/head.ejs %>
<% include ../partials/menu.ejs %>
<body >
<div class="container">
    <% if(!data.length) { %>
    <% include ../partials/no-data.ejs %>
    <% } else { %>
    <div class="card-deck-wrapper">
        <div class="card-deck">
            <div class="card">
                <div class="card-block">
                    <h4 class="card-title">
                        <span class="fa fa-database"></span> Stored data
                    </h4>
                    <hr>
                    <% for(let i = 0, len = data.length; i < len; ++i) { %>
                    <button class="btn btn-block " id="<%= data[i]._id %>"
                            onclick="fillContent('<%= data[i]._id %>')" style="color:#FCFCFC;">
                        <%= data[i].eleccion.fecha %> |
                        <%= data[i].provincia %> | <%= data[i].eleccion.autor.toUpperCase() %>
                        <span class="fa fa-chevron-circle-right" style="float:right;"></span>
                    </button>
                    <% } %>
                </div>
            </div>
            <div class="card">

                <div class="card-block">
                    <h4 class="card-title">
                        <span class="fa fa-check-circle-o"></span> Selected data
                    </h4>
                    <hr>
                    <div class="card-text" id="content">
                            <span class="fa fa-info-circle"></span> Click on a result in your left to see the content here!
                    </div>
                </div>
            </div>
        </div>
    </div>
    <% } %>
</div>
<script>
    function fillContent(id) {
        var content = '<ul class="list-group"> ';
        $.get('/resultados/' + id, function (data, status) {

            content += '<li class="list-group-item"><span class="fa fa-user"></span> ' + data.data.eleccion.autor + '</li>';
            content += '<li class="list-group-item"><span class="fa fa-calendar"></span> ' + data.data.eleccion.fecha + '</li>';
            content += '<li class="list-group-item"><span class="fa fa-map-o"></span> ' + data.data.comunidad + '</li>';
            content += '<li class="list-group-item"><span class="fa fa-map-marker"></span> ' + data.data.provincia + '(' + data.data.cod_provincia + ')</li>';
            content += '<li class="list-group-item"><span class="fa fa-group"></span> ' + data.data.poblacion + ' total population </li>';
            content += '<li class="list-group-item"><span class="fa fa-building-o"></span> ' + data.data.num_mesas + ' ellectoral colleages</li>';
            content += '<li class="list-group-item"><span class="fa fa-group"></span> ' + data.data.total_censo_electoral + ' total ellectoral census</li>';
            content += '<li class="list-group-item"><span class="fa fa-group"></span> ' + data.data.total_votantes + ' voters</li>';
            content += '<li class="list-group-item"><span class="fa fa-check-circle-o"></span> ' + data.data.votos_validos + ' valid votes</li>';
            content += '<li class="list-group-item"><span class="fa fa-envelope"></span> ' + data.data.votos_candidaturas + ' parties votes</li>';
            content += '<li class="list-group-item"><span class="fa fa-envelope-o"></span> ' + data.data.votos_blanco + ' blank votes</li>';
            content += '<li class="list-group-item"><span class="fa fa-times-circle-o"></span> ' + data.data.votos_nulos + ' null votes</li>';
            content += '</ul>'
            content += '<br><h4><span class="fa fa-envelope-open-o"></span> votes:</h4><hr>';
            content += '<ul class="list-group"><li class="list-group-item"><pre>' + JSON.stringify(data.data.partidos, undefined, 4) + '</pre></li></ul>';

            $('#content').empty().append(content + '');
            $("html, body").animate({scrollTop: 0}, "slow");
        });

    }
</script>
<% include ../partials/footer %>
</body>
</html>
